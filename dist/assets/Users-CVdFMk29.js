import{s as S}from"./index-CT4aKzy7.js";import{s as V,a as L,b as N,c as z,d as B,e as R}from"./index-B6UJGvDB.js";import{s as T}from"./index-Cob0FvQU.js";import{s as q}from"./index-DLoo_FT-.js";import{_ as P,a as _,c as p,b as o,d as a,w as d,r as E,o as u,e as j,F as A,f as O,g as b,t as M,h as f,n as h,p as K,i as H,s as Y,j as G,k as J}from"./index-1PYYOqbW.js";import"./index-DF191kHI.js";const Q={data(){return{users:null,user:{},data:{},columns:null,totalRecords:0,loading:!1,isLoading:!1,params:{},filters:"",deleteDialog:!1,usersDialog:!1,submitted:!1,submittedUpdate:!1,eyeHidden:!0}},created(){this.columns=[{field:"name",header:"Name",style:"min-width:150px;"},{field:"email",header:"Email",style:"min-width:180px;"},{field:"username",header:"Username",style:"min-width:150px;"}]},mounted(){this.loadData()},methods:{async loadData(){const i=localStorage.getItem("token");this.loading=!0,this.params.filters=this.filters;const s=Object.keys(this.params).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(this.params[l])).join("&"),r=await _.get("v1/user?"+s,{headers:{Authorization:`Bearer ${i}`}}).catch(l=>{this.loading=!1;const e=l.response.data;e.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:e.data.errors,life:3e3})});if(r.data.meta.code==200){const l=r.data;this.users=l.data.data,this.totalRecords=l.data.countData,this.loading=!1}},onPage(i){this.params=i.originalEvent,this.params.sortField=i.sortField,this.params.sortOrder=i.sortOrder,this.loadData()},onSort(i){this.params.sortField=i.sortField,this.params.sortOrder=i.sortOrder,this.loadData()},onFilter(){this.loadData()},refresh(){this.loadData()},newData(){this.user={},this.submitted=!1,this.submittedUpdate=!1,this.usersDialog=!0,this.isLoading=!1},hideDialog(){this.usersDialog=!1,this.submitted=!1,this.submittedUpdate=!1,this.isLoading=!1},editData(i){this.user={...i},this.usersDialog=!0,this.submitted=!1,this.submittedUpdate=!0},async saveData(){const i=localStorage.getItem("token");if(this.isLoading=!0,this.user.ID)if(this.submittedUpdate=!0,this.user.username.trim()&&this.user.name.trim()&&this.user.email.trim()){let s={};s.name=this.user.name,this.user.password&&(s.password=this.user.password),s.username=this.user.username,s.email=this.user.email,s.id=this.user.ID;const r=await _.put("v1/user",s,{headers:{Authorization:`Bearer ${i}`}}).catch(l=>{this.isLoading=!1;const e=l.response.data;e.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):(this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:e.data.errors,life:3e3}))});if(r.data.meta.code==200){await this.loadData();const l=r.data;this.isLoading=!1,this.usersDialog=!1,this.$toast.add({severity:"success",summary:l.meta.message,detail:"User has been updated!",life:3e3})}}else this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:"Input must be required!",life:3e3});else if(this.submitted=!0,this.user.username&&this.user.password&&this.user.email.trim()&&this.user.name){const s={name:this.user.name,username:this.user.username,password:this.user.password,email:this.user.email},r=await _.post("v1/user",s,{headers:{Authorization:`Bearer ${i}`}}).catch(l=>{this.isLoading=!1;const e=l.response.data;e.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:e.data.errors,life:5e3})});if(r.data.meta.code==201){await this.loadData();const l=r.data;this.usersDialog=!1,this.isLoading=!1,this.$toast.add({severity:"success",summary:l.meta.message,detail:"User has been added!",life:3e3})}}else this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:"Input must be required!",life:3e3})},confirmDelete(i){this.user=i,this.deleteDialog=!0},async deleteData(){if(this.user.ID){const i=localStorage.getItem("token"),s=await _.delete("v1/user/"+this.user.ID,{headers:{Authorization:`Bearer ${i}`}}).catch(r=>{this.loading=!1;const l=r.response.data;l.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:l.data.errors,life:3e3})});if(s.data.meta.code==200){const r=s.data;this.loading=!1,this.deleteDialog=!1,this.loadData(),this.$toast.add({severity:"success",summary:r.meta.message,detail:"User has been deleted!",life:3e3})}}else this.$toast.add({severity:"error",summary:"Failed!",detail:"Please reload data",life:3e3})}}},c=i=>(K("data-v-9ec28997"),i=i(),H(),i),W={class:"grid"},X={class:"col-12"},Z={class:"col-12"},$={class:"card"},ee=c(()=>a("h5",null,"Users Data",-1)),se={class:"my-2"},te={class:"flex flex-wrap gap-2 items-center justify-between"},ae=c(()=>a("i",{class:"pi pi-search"},null,-1)),ie={class:"flex align-items-center justify-content-center"},oe=c(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),le={key:0},re=c(()=>a("svg",{class:"pl",width:"240",height:"240",viewBox:"0 0 240 240"},[a("circle",{class:"pl__ring pl__ring--a",cx:"120",cy:"120",r:"105",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 660","stroke-dashoffset":"-330","stroke-linecap":"round"}),a("circle",{class:"pl__ring pl__ring--b",cx:"120",cy:"120",r:"35",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 220","stroke-dashoffset":"-110","stroke-linecap":"round"}),a("circle",{class:"pl__ring pl__ring--c",cx:"85",cy:"120",r:"70",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 440","stroke-linecap":"round"}),a("circle",{class:"pl__ring pl__ring--d",cx:"155",cy:"120",r:"70",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 440","stroke-linecap":"round"})],-1)),ne=[re],de={class:"grid grid-cols-12 gap-4 mb-5"},ue={class:"col-span-6"},ce=c(()=>a("label",{for:"username"},"Username",-1)),me={key:0,class:"p-invalid-text"},pe={class:"col-span-6"},he=c(()=>a("label",{for:"password"},"Password",-1)),fe={key:0,class:"p-invalid-text"},ge={class:"grid grid-cols-12 gap-4"},_e={class:"col-span-6"},ve=c(()=>a("label",{for:"fullname"},"Name",-1)),ye={key:0,class:"p-invalid-text"},be={class:"col-span-6"},ke=c(()=>a("label",{for:"email"},"Email",-1)),we={key:0,class:"p-invalid-text"};function De(i,s,r,l,e,n){const k=Y,w=E("router-view"),m=q,D=N,g=T,x=z,U=B,v=R,I=V,y=L,C=S;return u(),p("div",W,[o(k),a("div",X,[o(w,{onRefreshTable:n.refresh},null,8,["onRefreshTable"])]),a("div",Z,[a("div",$,[ee,o(I,{lazy:!0,paginator:!0,scrollable:!0,scrollHeight:"flex",wrapper:!0,rows:10,value:e.users,totalRecords:e.totalRecords,loading:e.loading,onPage:s[2]||(s[2]=t=>n.onPage(t)),onSort:s[3]||(s[3]=t=>n.onSort(t)),onFilter:s[4]||(s[4]=t=>n.onFilter(t)),ref:"dt",dataKey:"id",responsiveLayout:"scroll"},{default:d(()=>[o(U,{class:"mb-4"},{start:d(()=>[a("div",se,[o(m,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:n.newData},null,8,["onClick"])])]),end:d(()=>[a("div",te,[o(x,null,{default:d(()=>[o(D,null,{default:d(()=>[ae]),_:1}),o(g,{modelValue:e.filters,"onUpdate:modelValue":s[0]||(s[0]=t=>e.filters=t),placeholder:"Search...",onKeydown:s[1]||(s[1]=j(t=>n.onFilter(),["enter"]))},null,8,["modelValue"])]),_:1})])]),_:1}),(u(!0),p(A,null,O(e.columns,t=>(u(),G(v,{field:t.field,header:t.header,key:t.field,sortable:!0,style:J(t.style)},null,8,["field","header","style"]))),128)),o(v,{headerStyle:"min-width:10rem;",frozen:"",alignFrozen:"right"},{body:d(t=>[o(m,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:F=>n.editData(t.data)},null,8,["onClick"]),o(m,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:F=>n.confirmDelete(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","totalRecords","loading"]),o(y,{visible:e.deleteDialog,"onUpdate:visible":s[6]||(s[6]=t=>e.deleteDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[o(m,{label:"No",icon:"pi pi-times",class:"p-button-secondary",onClick:s[5]||(s[5]=t=>e.deleteDialog=!1)}),o(m,{label:"Yes",icon:"pi pi-check",class:"p-button-danger",onClick:n.deleteData},null,8,["onClick"])]),default:d(()=>[a("div",ie,[oe,e.user?(u(),p("span",le,[b("Are you sure you want to delete "),a("b",null,M(e.user.name),1),b("?")])):f("",!0)])]),_:1},8,["visible"]),o(y,{visible:e.usersDialog,"onUpdate:visible":s[11]||(s[11]=t=>e.usersDialog=t),style:{width:"550px",position:"relatif"},header:"Form User",modal:!0,class:"p-fluid"},{footer:d(()=>[o(m,{label:"Cancel",icon:"pi pi-times",text:"",onClick:n.hideDialog},null,8,["onClick"]),o(m,{label:"Save",icon:"pi pi-check",onClick:n.saveData},null,8,["onClick"])]),default:d(()=>[a("div",{class:h(e.isLoading?"canvas-loading loading-icon":"canvas-loading loading-icon-hide")},ne,2),a("div",{class:h(e.isLoading?"canvas-form-opacity":"canvas-form")},[a("div",de,[a("div",ue,[ce,o(g,{id:"username",placeholder:"Username",modelValue:e.user.username,"onUpdate:modelValue":s[7]||(s[7]=t=>e.user.username=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:h({"p-invalid":e.submitted&&!e.user.username}),fluid:""},null,8,["modelValue","class"]),(e.submitted||e.submittedUpdate)&&!e.user.username?(u(),p("small",me,"User Name is required.")):f("",!0)]),a("div",pe,[he,o(C,{id:"password1",placeholder:"Password",toggleMask:!0,class:h(e.submitted&&!e.user.password?"p-invalid":""),modelValue:e.user.password,"onUpdate:modelValue":s[8]||(s[8]=t=>e.user.password=t),fluid:"",feedback:!1},null,8,["class","modelValue"]),e.submitted&&!e.user.password?(u(),p("small",fe,"Password is required.")):f("",!0)])]),a("div",ge,[a("div",_e,[ve,o(g,{id:"fullname",placeholder:"Name",modelValue:e.user.name,"onUpdate:modelValue":s[9]||(s[9]=t=>e.user.name=t),modelModifiers:{trim:!0},autofocus:"",class:h({"p-invalid":e.submitted&&!e.user.fullname}),fluid:""},null,8,["modelValue","class"]),(e.submitted||e.submittedUpdate)&&!e.user.name?(u(),p("small",ye,"Name is required.")):f("",!0)]),a("div",be,[ke,o(g,{id:"email",type:"email",placeholder:"Email",modelValue:e.user.email,"onUpdate:modelValue":s[10]||(s[10]=t=>e.user.email=t),modelModifiers:{trim:!0},autofocus:"",class:h({"p-invalid":e.submitted&&!e.user.email}),fluid:""},null,8,["modelValue","class"]),(e.submitted||e.submittedUpdate)&&!e.user.email?(u(),p("small",we,"Email is required.")):f("",!0)])])],2)]),_:1},8,["visible"])])])])}const Ve=P(Q,[["render",De],["__scopeId","data-v-9ec28997"]]);export{Ve as default};
