import{s as H,a as V,b as L,c as N,d as R,e as T,f as B}from"./index-B6UJGvDB.js";import{s as J}from"./index-Cob0FvQU.js";import{s as M}from"./index-DLoo_FT-.js";import{_ as z,a as p,c as h,b as o,d as s,w as m,r as U,o as c,e as q,g as y,t as b,h as f,n as g,p as A,i as K,s as O}from"./index-1PYYOqbW.js";const P={data(){return{master_hutangs:null,master_hutang:{},data:{},columns:null,totalRecords:0,loading:!1,isLoading:!1,params:{},filters:"",deleteDialog:!1,masterHutangDialog:!1,submitted:!1}},created(){this.columns=[{field:"nama_hutang",header:"Nama Hutang",style:"min-width:150px;"},{field:"jumlah_maksimal",header:"Jumlah maksimal",style:"min-width:150px;"},{field:"jatuh_tempo",header:"Jatuh Tempo",style:"min-width:150px;"}]},mounted(){this.loadData()},methods:{formatRupiah(){let e=this.master_hutang.jumlah_maksimal.toString().replace(/\D/g,""),a=new Intl.NumberFormat("id-ID",{maximumFractionDigits:0}).format(e);this.master_hutang.jumlah_maksimal=a},formatRupiahData(e){let a;return a=e.toString().replace(/\D/g,""),new Intl.NumberFormat("id-ID",{maximumFractionDigits:0}).format(a)},async loadData(){const e=localStorage.getItem("token");this.loading=!0,this.params.filters=this.filters;const a=Object.keys(this.params).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(this.params[l])).join("&"),r=await p.get("v1/master_hutang?"+a,{headers:{Authorization:`Bearer ${e}`}}).catch(l=>{this.loading=!1;const t=l.response.data;t.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:t.data.errors,life:3e3})});if(r.data.meta.code==200){const l=r.data;this.master_hutangs=l.data.data,this.totalRecords=l.data.countData,this.loading=!1}},onPage(e){this.params=e.originalEvent,this.params.sortField=e.sortField,this.params.sortOrder=e.sortOrder,this.loadData()},onSort(e){this.params.sortField=e.sortField,this.params.sortOrder=e.sortOrder,this.loadData()},onFilter(){this.loadData()},refresh(){this.loadData()},newData(){this.master_hutang={},this.master_hutang.jumlah_maksimal="",this.submitted=!1,this.masterHutangDialog=!0,this.isLoading=!1},hideDialog(){this.masterHutangDialog=!1,this.submitted=!1,this.isLoading=!1},editData(e){this.master_hutang={...e},this.formatRupiah(),this.masterHutangDialog=!0,this.submitted=!1},async saveData(){const e=localStorage.getItem("token");if(this.isLoading=!0,this.master_hutang.ID)if(this.submitted=!0,this.master_hutang.nama_hutang&&this.master_hutang.jumlah_maksimal&&this.master_hutang.jatuh_tempo){let a={id:this.master_hutang.ID,nama_hutang:this.master_hutang.nama_hutang,jumlah_maksimal:parseInt(this.master_hutang.jumlah_maksimal.replace(/\./g,"")),jatuh_tempo:this.master_hutang.jatuh_tempo};const r=await p.put("v1/master_hutang",a,{headers:{Authorization:`Bearer ${e}`}}).catch(l=>{this.isLoading=!1;const t=l.response.data;t.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):(this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:t.data.errors,life:3e3}))});if(r.data.meta.code==200){await this.loadData();const l=r.data;this.isLoading=!1,this.masterHutangDialog=!1,this.$toast.add({severity:"success",summary:l.meta.message,detail:"Master hutang has been updated!",life:3e3})}}else this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:"Input must be required!",life:3e3});else if(this.submitted=!0,this.master_hutang.nama_hutang&&this.master_hutang.jumlah_maksimal&&this.master_hutang.jatuh_tempo){const a={nama_hutang:this.master_hutang.nama_hutang,jumlah_maksimal:parseInt(this.master_hutang.jumlah_maksimal.replace(/\./g,"")),jatuh_tempo:this.master_hutang.jatuh_tempo},r=await p.post("v1/master_hutang",a,{headers:{Authorization:`Bearer ${e}`}}).catch(l=>{this.isLoading=!1;const t=l.response.data;t.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:t.data.errors,life:5e3})});if(r.data.meta.code==201){await this.loadData();const l=r.data;this.masterHutangDialog=!1,this.isLoading=!1,this.$toast.add({severity:"success",summary:l.meta.message,detail:"master hutang has been added!",life:3e3})}}else this.isLoading=!1,this.$toast.add({severity:"error",summary:"Failed!",detail:"Input must be required!",life:3e3})},confirmDelete(e){this.master_hutang=e,this.deleteDialog=!0},async deleteData(){if(this.master_hutang.ID){const e=localStorage.getItem("token"),a=await p.delete("v1/master_hutang/"+this.master_hutang.ID,{headers:{Authorization:`Bearer ${e}`}}).catch(r=>{this.loading=!1;const l=r.response.data;l.meta.code==401?(localStorage.removeItem("token"),this.$router.push({name:"login"})):this.$toast.add({severity:"error",summary:"Failed!",detail:l.data.errors,life:3e3})});if(a.data.meta.code==200){const r=a.data;this.loading=!1,this.deleteDialog=!1,this.loadData(),this.$toast.add({severity:"success",summary:r.meta.message,detail:"Master hutang has been deleted!",life:3e3})}}else this.$toast.add({severity:"error",summary:"Failed!",detail:"Please reload data",life:3e3})}}},u=e=>(A("data-v-9e07b983"),e=e(),K(),e),E={class:"grid"},Y={class:"col-12"},G={class:"col-12"},Q={class:"card"},W=u(()=>s("h5",null,"Master Hutang Data",-1)),X={class:"my-2"},Z={class:"flex flex-wrap gap-2 items-center justify-between"},$=u(()=>s("i",{class:"pi pi-search"},null,-1)),tt={class:"flex align-items-center justify-content-center"},at=u(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),et={key:0},st=u(()=>s("svg",{class:"pl",width:"240",height:"240",viewBox:"0 0 240 240"},[s("circle",{class:"pl__ring pl__ring--a",cx:"120",cy:"120",r:"105",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 660","stroke-dashoffset":"-330","stroke-linecap":"round"}),s("circle",{class:"pl__ring pl__ring--b",cx:"120",cy:"120",r:"35",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 220","stroke-dashoffset":"-110","stroke-linecap":"round"}),s("circle",{class:"pl__ring pl__ring--c",cx:"85",cy:"120",r:"70",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 440","stroke-linecap":"round"}),s("circle",{class:"pl__ring pl__ring--d",cx:"155",cy:"120",r:"70",fill:"none",stroke:"#000","stroke-width":"20","stroke-dasharray":"0 440","stroke-linecap":"round"})],-1)),it=[st],ot={class:"grid grid-cols-12 gap-4 mb-5"},lt={class:"col-span-6"},rt=u(()=>s("label",{for:"nama_hutang"},"Nama Hutang",-1)),nt={key:0,class:"p-invalid-text"},mt={class:"col-span-6"},dt=u(()=>s("label",{for:"jumlah_maksimal"},"Jumlah Maksimal",-1)),ut={key:0,class:"p-invalid-text"},ht={class:"grid grid-cols-12 gap-4"},ct={class:"col-span-6"},gt=u(()=>s("label",{for:"jatuh_tempo"},"Jatuh Tempo(Hari)",-1)),_t={key:0,class:"p-invalid-text"};function pt(e,a,r,l,t,n){const D=O,w=U("router-view"),d=M,j=L,k=J,x=N,I=R,_=T,C=H,v=V,F=B;return c(),h("div",E,[o(D),s("div",Y,[o(w,{onRefreshTable:n.refresh},null,8,["onRefreshTable"])]),s("div",G,[s("div",Q,[W,o(C,{lazy:!0,paginator:!0,scrollable:!0,scrollHeight:"flex",wrapper:!0,rows:10,value:t.master_hutangs,totalRecords:t.totalRecords,loading:t.loading,onPage:a[2]||(a[2]=i=>n.onPage(i)),onSort:a[3]||(a[3]=i=>n.onSort(i)),onFilter:a[4]||(a[4]=i=>n.onFilter(i)),ref:"dt",dataKey:"id",responsiveLayout:"scroll"},{default:m(()=>[o(I,{class:"mb-4"},{start:m(()=>[s("div",X,[o(d,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:n.newData},null,8,["onClick"])])]),end:m(()=>[s("div",Z,[o(x,null,{default:m(()=>[o(j,null,{default:m(()=>[$]),_:1}),o(k,{modelValue:t.filters,"onUpdate:modelValue":a[0]||(a[0]=i=>t.filters=i),placeholder:"Search...",onKeydown:a[1]||(a[1]=q(i=>n.onFilter(),["enter"]))},null,8,["modelValue"])]),_:1})])]),_:1}),o(_,{field:"nama_hutang",header:"Nama Hutang",style:{"min-width":"150px"}}),o(_,{header:"Jumlah Maksimal",style:{"min-width":"150px"}},{body:m(i=>[y(b(n.formatRupiahData(i.data.jumlah_maksimal)),1)]),_:1}),o(_,{field:"jatuh_tempo",header:"Jatuh Tempo(Hari)",style:{"min-width":"150px"}}),o(_,{headerStyle:"min-width:10rem;",frozen:"",alignFrozen:"right"},{body:m(i=>[o(d,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:S=>n.editData(i.data)},null,8,["onClick"]),o(d,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:S=>n.confirmDelete(i.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","totalRecords","loading"]),o(v,{visible:t.deleteDialog,"onUpdate:visible":a[6]||(a[6]=i=>t.deleteDialog=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:m(()=>[o(d,{label:"No",icon:"pi pi-times",class:"p-button-secondary",onClick:a[5]||(a[5]=i=>t.deleteDialog=!1)}),o(d,{label:"Yes",icon:"pi pi-check",class:"p-button-danger",onClick:n.deleteData},null,8,["onClick"])]),default:m(()=>[s("div",tt,[at,t.master_hutang?(c(),h("span",et,[y("Are you sure you want to delete "),s("b",null,b(t.master_hutang.nama_hutang),1),y("?")])):f("",!0)])]),_:1},8,["visible"]),o(v,{visible:t.masterHutangDialog,"onUpdate:visible":a[10]||(a[10]=i=>t.masterHutangDialog=i),style:{width:"550px",position:"relatif"},header:"Form Master Hutang",modal:!0,class:"p-fluid"},{footer:m(()=>[o(d,{label:"Cancel",icon:"pi pi-times",text:"",onClick:n.hideDialog},null,8,["onClick"]),o(d,{label:"Save",icon:"pi pi-check",onClick:n.saveData},null,8,["onClick"])]),default:m(()=>[s("div",{class:g(t.isLoading?"canvas-loading loading-icon":"canvas-loading loading-icon-hide")},it,2),s("div",{class:g(t.isLoading?"canvas-form-opacity":"canvas-form")},[s("div",ot,[s("div",lt,[rt,o(k,{id:"nama_hutang",placeholder:"Nama Hutang",modelValue:t.master_hutang.nama_hutang,"onUpdate:modelValue":a[7]||(a[7]=i=>t.master_hutang.nama_hutang=i),modelModifiers:{trim:!0},required:"true",autofocus:"",class:g({"p-invalid":t.submitted&&!t.master_hutang.nama_hutang}),fluid:""},null,8,["modelValue","class"]),t.submitted&&!t.master_hutang.nama_hutang?(c(),h("small",nt,"Nama hutang is required.")):f("",!0)]),s("div",mt,[dt,o(k,{id:"jumlah_maksimal",placeholder:"Jumlah Maksimal",modelValue:t.master_hutang.jumlah_maksimal,"onUpdate:modelValue":a[8]||(a[8]=i=>t.master_hutang.jumlah_maksimal=i),modelModifiers:{trim:!0},autofocus:"",class:g({"p-invalid":t.submitted&&!t.master_hutang.jumlah_maksimal}),fluid:"",onKeyup:n.formatRupiah},null,8,["modelValue","class","onKeyup"]),t.submitted&&!t.master_hutang.jumlah_maksimal?(c(),h("small",ut,"Jumlah maksimal is required.")):f("",!0)])]),s("div",ht,[s("div",ct,[gt,o(F,{id:"jatuh_tempo",placeholder:"Jatuh Tempo(Hari)",modelValue:t.master_hutang.jatuh_tempo,"onUpdate:modelValue":a[9]||(a[9]=i=>t.master_hutang.jatuh_tempo=i),autofocus:"",class:g({"p-invalid":t.submitted&&!t.master_hutang.jatuh_tempo}),showButtons:"",mode:"decimal"},null,8,["modelValue","class"]),t.submitted&&!t.master_hutang.jatuh_tempo?(c(),h("small",_t,"Jatuh tempo is required.")):f("",!0)])])],2)]),_:1},8,["visible"])])])])}const bt=z(P,[["render",pt],["__scopeId","data-v-9e07b983"]]);export{bt as default};
